# ==========================================
# GHOSTPORT CONFIGURATION v3.0 (RBAC + TOTP)
# ==========================================

[server]
listen_ip = "0.0.0.0"
listen_port = 8443
tls_enabled = true
cert_path = "./certs/server.crt"
key_path = "./certs/server.key"
max_connections = 1000

[backend]
target_addr = "127.0.0.1:8080"
target_host = "myapp.local"

[security]
auth_mode = "user_totp"
replay_window = 90
enable_deep_analysis = true
session_timeout = 300

[security.ban]
enabled = true
ban_duration = 3600
max_violations = 3

# --- USERS ---

[[users]]
username = "pedro"
roles = ["superadmin", "dev"] 
secret = "JBSWY3DPEHPK3PXPJBSWY3DPEHPK3PXP" 

[[users]]
username = "bob"
roles = ["auditor"]
secret = "KBSWY3DPEHPK3PXPKBSWY3DPEHPK3PXP"

# --- RULES ---

# Rule 1: The Fortress (Only SuperAdmins)
[[rules]]
path = "/admin"
type = "private"
allowed_roles = ["superadmin"] 
on_fail = "honeypot"

# Rule 2: The Logs (Auditors AND SuperAdmins)
[[rules]]
path = "/logs"
type = "private"
allowed_roles = ["superadmin", "auditor"]
on_fail = "block"

# Rule 3: Public
[[rules]]
path = "/"
type = "public"
strict_waf = true
on_fail = "block"

[reporting]
webhook_url = "https://discord.com/api/webhooks/12345/abcde"
log_all_requests = false
